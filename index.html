<!DOCTYPE html>
<title lang="en">Life</title>
<canvas id="life" width="500" height="500"></canvas>
<script>
var canvas = document.getElementById('life');
var context = canvas.getContext('2d');
var currentPixels = context.getImageData(0, 0, canvas.width, canvas.height);
var newPixels = context.createImageData(canvas.width, canvas.height);

board=new Array()
temp=new Array()
for (i=0;i<canvas.height;i++){
	board[i]=new Array()
	temp[i]=new Array()
	for (j=0;j<canvas.width;j++){
		board[i][j]=((Math.random()>.5)?1:0)
  }
}
function nSum(){
	iP=(i-1+canvas.height)%canvas.height;
	iN=(i+1)%canvas.height;
	jP=(j-1+canvas.width)%canvas.width;
	jN=(j+1)%canvas.width;
	
	return board[iP][jP]+
	       board[iP][j]+
	       board[iP][jN]+
	       board[i][jP]+
	       board[i][jN]+
	       board[iN][jP]+
	       board[iN][j]+
	       board[iN][jN]
}

function update(){
	for (i=0;i<canvas.height;i++){
		for (j=0;j<canvas.width;j++){
			sum=nSum()
			if (sum==3){
				temp[i][j]=1}
			else if (sum==2 & board[i][j]==1){
				temp[i][j]=1}
			else{
				temp[i][j]=0}}}			
	for (i=0;i<canvas.height;i++){
		for (j=0;j<canvas.width;j++){
			board[i][j]=temp[i][j]}}
	
	for (i=0;i<newPixels.height;i++) {
		for (j=0;j<newPixels.width;j++) {
			for (c=0;c<3;c++) {
				var index = (i*newPixels.width + j)*4 + c;
					newPixels.data[index] = 255*(1-board[i][j]);
			}
				var alphaIndex = (i*newPixels.width + j)*4 + 3;
				newPixels.data[alphaIndex] = 255;
		}
	}
	context.putImageData(newPixels, 0, 0);
	t=setTimeout("update()",1);
}

update()
</script>
